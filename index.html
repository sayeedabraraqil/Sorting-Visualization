<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Merge Sort vs Quick Sort Visualization</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f4f4;
        text-align: center;
    }

    h1 {
        margin-bottom: 10px;
    }

    .container {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
    }

    .algo {
        width: 45%;
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .bars {
        display: flex;
        align-items: flex-end;
        height: 300px;
        margin-top: 20px;
        border: 1px solid #ddd;
    }

    .bar {
        background: steelblue;
        margin: 1px;
        width: 100%;
        transition: height 0.2s, background 0.2s;
    }

    button {
        margin: 10px;
        padding: 8px 15px;
        font-size: 14px;
        cursor: pointer;
    }
</style>
</head>

<body>

<h1>Merge Sort vs Quick Sort</h1>

<button onclick="start()">Start Sorting</button>
<button onclick="reset()">Reset</button>

<div class="container">
    <div class="algo">
        <h2>Merge Sort</h2>
        <div id="mergeBars" class="bars"></div>
    </div>

    <div class="algo">
        <h2>Quick Sort</h2>
        <div id="quickBars" class="bars"></div>
    </div>
</div>

<script>
const SIZE = 30;
const SPEED = 100;

let array = [];
let mergeArray = [];
let quickArray = [];

function generateArray() {
    array = [];
    for (let i = 0; i < SIZE; i++) {
        array.push(Math.floor(Math.random() * 250) + 20);
    }
    mergeArray = [...array];
    quickArray = [...array];
}

function render(container, arr, colors = []) {
    container.innerHTML = "";
    arr.forEach((value, i) => {
        const bar = document.createElement("div");
        bar.classList.add("bar");
        bar.style.height = value + "px";
        bar.style.width = (100 / SIZE) + "%";
        bar.style.background = colors[i] || "steelblue";
        container.appendChild(bar);
    });
}

async function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

/* MERGE SORT */
async function mergeSort(arr, l, r, container) {
    if (l >= r) return;
    const m = Math.floor((l + r) / 2);
    await mergeSort(arr, l, m, container);
    await mergeSort(arr, m + 1, r, container);
    await merge(arr, l, m, r, container);
}

async function merge(arr, l, m, r, container) {
    const left = arr.slice(l, m + 1);
    const right = arr.slice(m + 1, r + 1);

    let i = 0, j = 0, k = l;

    while (i < left.length && j < right.length) {
        arr[k] = left[i] <= right[j] ? left[i++] : right[j++];
        render(container, arr, { [k]: "red" });
        await sleep(SPEED);
        k++;
    }

    while (i < left.length) {
        arr[k] = left[i++];
        render(container, arr, { [k]: "red" });
        await sleep(SPEED);
        k++;
    }

    while (j < right.length) {
        arr[k] = right[j++];
        render(container, arr, { [k]: "red" });
        await sleep(SPEED);
        k++;
    }
}

/* QUICK SORT */
async function quickSort(arr, low, high, container) {
    if (low < high) {
        const pi = await partition(arr, low, high, container);
        await quickSort(arr, low, pi - 1, container);
        await quickSort(arr, pi + 1, high, container);
    }
}

async function partition(arr, low, high, container) {
    const pivot = arr[high];
    let i = low - 1;

    for (let j = low; j < high; j++) {
        if (arr[j] < pivot) {
            i++;
            [arr[i], arr[j]] = [arr[j], arr[i]];
            render(container, arr, { [i]: "red", [j]: "red" });
            await sleep(SPEED);
        }
    }

    [arr[i + 1], arr[high]] = [arr[high], arr[i + 1]];
    render(container, arr, { [i + 1]: "green" });
    await sleep(SPEED);

    return i + 1;
}

/* CONTROLS */
async function start() {
    await Promise.all([
        mergeSort(mergeArray, 0, mergeArray.length - 1, mergeBars),
        quickSort(quickArray, 0, quickArray.length - 1, quickBars)
    ]);
}

function reset() {
    generateArray();
    render(mergeBars, mergeArray);
    render(quickBars, quickArray);
}

const mergeBars = document.getElementById("mergeBars");
const quickBars = document.getElementById("quickBars");

reset();
</script>

</body>
</html>
